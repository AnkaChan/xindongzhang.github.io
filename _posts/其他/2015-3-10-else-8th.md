---
layout: post
category: else
title: 安卓开发：android studio + ndk + jni
---

最近要做一个android的小项目，之前虽然接触过java，但是基本不熟悉android。看了一下午的文档，安装好android studio和ndk就匆匆忙忙先进行测试。

1. 建立工程NDKDemo，在项目中建立MathKit这个java类（实现计算int的平方）

![img1](https://raw.githubusercontent.com/xindongzhang/xindongzhang.github.io/master/_posts/BlogSrc/AndroidStudio/1.png)

2. 进入到java目录，利用javah -jni XXXX编译出该java类对应的头文件
3. 在main/java/yourfolder中建立jnipackage，然后把编译完的头文件转移到这个里面

![img1](https://raw.githubusercontent.com/xindongzhang/xindongzhang.github.io/master/_posts/BlogSrc/AndroidStudio/2.png)

4. 实现该头文件对应的cpp
5. 设置项目：1.设置根目录中的local.property，使得编译的时候能找到ndk；2.设置app项目build.gradle里面的defaultconfig加入生成jni的名称。
6. 主文件调用改成如下即可。

![img1](https://raw.githubusercontent.com/xindongzhang/xindongzhang.github.io/master/_posts/BlogSrc/AndroidStudio/3.png)

### 遇到的一些问题
* ndk+jni：有个地方比较奇葩，不能只实现一个类，所以只能再新建一个空的类来避免出错。
* 碰到没有配置好ndk的问题，检查一下第5步的配置有没有问题。
